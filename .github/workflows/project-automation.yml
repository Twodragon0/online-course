name: Project Automation

on:
  issues:
    types: [opened, labeled, closed]
  pull_request:
    types: [opened, labeled, closed, ready_for_review]

jobs:
  add-to-project:
    name: Add to Project
    runs-on: ubuntu-latest
    if: github.event.action == 'opened'
    
    steps:
      - name: Add issue/PR to project
        uses: actions/add-to-project@v0.4.1
        with:
          project-url: ${{ secrets.PROJECT_URL }}
          github-token: ${{ secrets.GITHUB_TOKEN }}

  update-status:
    name: Update Status Based on Labels
    runs-on: ubuntu-latest
    
    steps:
      - name: Check labels
        id: check-labels
        run: |
          LABELS="${{ github.event.label.name }}"
          if echo "$LABELS" | grep -q "in-progress"; then
            echo "status=in-progress" >> $GITHUB_OUTPUT
          elif echo "$LABELS" | grep -q "review"; then
            echo "status=review" >> $GITHUB_OUTPUT
          elif echo "$LABELS" | grep -q "blocked"; then
            echo "status=blocked" >> $GITHUB_OUTPUT
          else
            echo "status=none" >> $GITHUB_OUTPUT
          fi

      - name: Comment on blocked issues
        if: steps.check-labels.outputs.status == 'blocked'
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'ğŸš« ì´ ì´ìŠˆëŠ” ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ì¶”ê°€ ì •ë³´ê°€ í•„ìš”í•˜ë©´ ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì„¸ìš”.'
            })



