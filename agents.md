# Agents

ì´ ë¬¸ì„œëŠ” ì˜¨ë¼ì¸ ì½”ìŠ¤ í”Œëž«í¼ í”„ë¡œì íŠ¸ì˜ êµ¬ì¡°, ê°œë°œ ê°€ì´ë“œë¼ì¸, ê·¸ë¦¬ê³  AI ì½”ë”© ì—ì´ì „íŠ¸ê°€ í”„ë¡œì íŠ¸ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì´í•´í•˜ê³  ìž‘ì—…í•  ìˆ˜ ìžˆë„ë¡ í•„ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” Next.js 14 ê¸°ë°˜ì˜ í˜„ëŒ€ì ì¸ ì˜¨ë¼ì¸ ì½”ìŠ¤ í”Œëž«í¼ìž…ë‹ˆë‹¤. DevSecOps ë° í´ë¼ìš°ë“œ ë³´ì•ˆ ê°•ì˜ë¥¼ ì œê³µí•˜ë©°, AI ê¸°ë°˜ ì±„íŒ… ì–´ì‹œìŠ¤í„´íŠ¸, ë¹„ë””ì˜¤ ìž¬ìƒ, êµ¬ë… ë° ê²°ì œ ê¸°ëŠ¥ì„ í¬í•¨í•©ë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥

- ðŸ“º **ë¹„ë””ì˜¤ ìž¬ìƒ**: YouTube ë° Google Drive ë¹„ë””ì˜¤ ì§€ì›
- ðŸ’¬ **AI ì±„íŒ…**: DeepSeek AIë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ í•™ìŠµ ì–´ì‹œìŠ¤í„´íŠ¸
- ðŸŽ¯ **ì½”ìŠ¤ ê´€ë¦¬**: ì½”ìŠ¤ ë° ë¹„ë””ì˜¤ ì½˜í…ì¸  ê´€ë¦¬
- ðŸ’³ **ê²°ì œ ì‹œìŠ¤í…œ**: Stripe ë° PayPal í†µí•©
- ðŸ” **ì¸ì¦ ë° ê¶Œí•œ**: NextAuth.js ê¸°ë°˜ ì‚¬ìš©ìž ì¸ì¦
- ðŸ“Š **êµ¬ë… ê´€ë¦¬**: ì‚¬ìš©ìž êµ¬ë… ìƒíƒœ ì¶”ì 
- ðŸ” **ë¹„ë””ì˜¤ ìš”ì•½**: AI ê¸°ë°˜ ë¹„ë””ì˜¤ ìš”ì•½ ìƒì„±

## ê¸°ìˆ  ìŠ¤íƒ

### í”„ë¡ íŠ¸ì—”ë“œ
- **Next.js 14**: App Router ì‚¬ìš©
- **TypeScript**: íƒ€ìž… ì•ˆì •ì„± ë³´ìž¥
- **Tailwind CSS**: ìŠ¤íƒ€ì¼ë§
- **shadcn/ui**: UI ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **Lucide React**: ì•„ì´ì½˜ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **Framer Motion**: ì• ë‹ˆë©”ì´ì…˜

### ë°±ì—”ë“œ
- **Next.js API Routes**: ì„œë²„ ì‚¬ì´ë“œ API
- **Prisma**: ORM ë° ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬
- **PostgreSQL**: ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤
- **Redis**: Rate limiting ë° ìºì‹±
- **NextAuth.js**: ì¸ì¦ ì‹œìŠ¤í…œ

### ì™¸ë¶€ ì„œë¹„ìŠ¤
- **DeepSeek AI**: AI ì±„íŒ… ë° ìš”ì•½ ê¸°ëŠ¥
- **OpenAI**: GPT-4 ì§€ì› (Pro í”Œëžœ)
- **Google OAuth**: ì†Œì…œ ë¡œê·¸ì¸
- **Stripe**: ê²°ì œ ì²˜ë¦¬
- **PayPal**: ê²°ì œ ì²˜ë¦¬
- **Google Drive API**: ë¹„ë””ì˜¤ ìŠ¤í† ë¦¬ì§€
- **Vercel Blob**: íŒŒì¼ ì—…ë¡œë“œ

## ê°œë°œ í™˜ê²½

### í•„ìˆ˜ ìš”êµ¬ì‚¬í•­
- **Node.js**: >=18.17.0 <23.0.0
- **npm**: íŒ¨í‚¤ì§€ ê´€ë¦¬ìž
- **PostgreSQL**: ë°ì´í„°ë² ì´ìŠ¤
- **Redis**: Rate limiting (ì„ íƒì‚¬í•­)

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ ë³€ìˆ˜ë“¤ì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL="postgresql://user:password@localhost:5432/online-course"

# NextAuth
NEXTAUTH_SECRET="your-secret-key-min-32-chars"
NEXTAUTH_URL="http://localhost:3000"

# Google OAuth
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"

# AI ì„œë¹„ìŠ¤
DEEPSEEK_API_KEY="your-deepseek-api-key"
OPENAI_API_KEY="your-openai-api-key"

# Stripe
STRIPE_SECRET_KEY="your-stripe-secret-key"
STRIPE_PUBLISHABLE_KEY="your-stripe-publishable-key"
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="your-stripe-publishable-key"

# PayPal
PAYPAL_CLIENT_ID="your-paypal-client-id"
PAYPAL_CLIENT_SECRET="your-paypal-client-secret"

# Google Drive
GOOGLE_SERVICE_ACCOUNT_EMAIL="your-service-account-email"
GOOGLE_SERVICE_ACCOUNT_KEY="your-service-account-key"

# Vercel Blob (ì„ íƒì‚¬í•­)
BLOB_READ_WRITE_TOKEN="your-blob-token"

# Redis (ì„ íƒì‚¬í•­)
REDIS_URL="redis://localhost:6379"
```

## ë¹Œë“œ ë° ì‹¤í–‰

### ê°œë°œ ì„œë²„ ì‹¤í–‰
```bash
npm install
npx prisma generate
npx prisma migrate dev
npm run dev
```

### í”„ë¡œë•ì…˜ ë¹Œë“œ
```bash
npm run build
npm run start
```

### Vercel ë°°í¬ìš© ë¹Œë“œ
```bash
npm run vercel-build
```

### íƒ€ìž… ì²´í¬
```bash
npm run type-check
```

## ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬

### Prisma ìŠ¤í‚¤ë§ˆ
ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆëŠ” `prisma/schema.prisma`ì— ì •ì˜ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.

ì£¼ìš” ëª¨ë¸:
- **User**: ì‚¬ìš©ìž ì •ë³´ ë° êµ¬ë… ìƒíƒœ
- **Course**: ì½”ìŠ¤ ì •ë³´
- **Video**: ë¹„ë””ì˜¤ ì½˜í…ì¸ 
- **Chat**: AI ì±„íŒ… ê¸°ë¡
- **Subscription**: êµ¬ë… ì •ë³´
- **ChatLog**: ì±„íŒ… ë¡œê·¸

### ë§ˆì´ê·¸ë ˆì´ì…˜
```bash
# ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±
npx prisma migrate dev --name migration-name

# ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©
npx prisma migrate deploy

# Prisma Client ìƒì„±
npx prisma generate
```

### ì‹œë“œ ë°ì´í„°
```bash
npm run db:seed
# ë˜ëŠ”
ts-node prisma/seed.ts
```

## ì½”ë“œ ìŠ¤íƒ€ì¼ ë° ê°€ì´ë“œë¼ì¸

### ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°
- ëª¨ë“  UI ì»´í¬ë„ŒíŠ¸ëŠ” `/components/ui`ì— ìœ„ì¹˜
- íŽ˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ëŠ” `/app` ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜
- ìž¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸ëŠ” `/components`ì— ìœ„ì¹˜

### ShadCN ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©
- ëª¨ë“  UI ì»´í¬ë„ŒíŠ¸ëŠ” ShadCNì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
- ì»´í¬ë„ŒíŠ¸ ì„¤ì¹˜: `npx shadcn@latest add [component-name]`
- ì»´í¬ë„ŒíŠ¸ ê²½ë¡œ: `/components/ui`

### ì•„ì´ì½˜ ì‚¬ìš©
- ëª¨ë“  ì•„ì´ì½˜ì€ Lucide Reactë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
- Import í˜•ì‹: `import { IconName } from "lucide-react"`

### TypeScript
- TypeScript strict mode í™œì„±í™”
- ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì™€ í•¨ìˆ˜ì— íƒ€ìž… ì •ì˜ í•„ìš”
- `any` íƒ€ìž… ì‚¬ìš© ì§€ì–‘

### íŒŒì¼ ëª…ëª… ê·œì¹™
- ì»´í¬ë„ŒíŠ¸: PascalCase (ì˜ˆ: `VideoPlayer.tsx`)
- ìœ í‹¸ë¦¬í‹°: camelCase (ì˜ˆ: `video-utils.ts`)
- API ë¼ìš°íŠ¸: kebab-case (ì˜ˆ: `video-summary/route.ts`)

## API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ API
- `GET/POST /api/auth/[...nextauth]`: NextAuth ì¸ì¦ ì—”ë“œí¬ì¸íŠ¸
- `POST /api/register`: ì‚¬ìš©ìž ë“±ë¡

### ì½”ìŠ¤ ë° ë¹„ë””ì˜¤ API
- `GET /api/videos`: ë¹„ë””ì˜¤ ëª©ë¡ ì¡°íšŒ
- `GET /api/drive/videos`: Google Drive ë¹„ë””ì˜¤ ì¡°íšŒ
- `POST /api/video-summary`: ë¹„ë””ì˜¤ ìš”ì•½ ìƒì„±
- `POST /api/related-questions`: ê´€ë ¨ ì§ˆë¬¸ ìƒì„±

### ì±„íŒ… API
- `POST /api/chat`: AI ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
  - Rate limit: 20íšŒ/ë¶„
  - ìž…ë ¥ ê²€ì¦ ë° XSS ë°©ì§€ ì ìš©

### êµ¬ë… ë° ê²°ì œ API
- `GET /api/subscription`: êµ¬ë… ì •ë³´ ì¡°íšŒ
- `POST /api/subscription`: êµ¬ë… ìƒì„±/ì—…ë°ì´íŠ¸
- `POST /api/create-payment-session`: Stripe ê²°ì œ ì„¸ì…˜ ìƒì„±
- `GET /api/stripe`: Stripe ê³ ê° ì •ë³´ ì¡°íšŒ

### ì›¹í›…
- `POST /api/webhooks/stripe`: Stripe ì›¹í›… ì²˜ë¦¬
- `POST /api/webhooks/paypal`: PayPal ì›¹í›… ì²˜ë¦¬

### íŒŒì¼ ì—…ë¡œë“œ
- `POST /api/upload`: íŒŒì¼ ì—…ë¡œë“œ
- `DELETE /api/upload/delete`: íŒŒì¼ ì‚­ì œ

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ì¸ì¦ ë° ê¶Œí•œ
- NextAuth.jsë¥¼ í†µí•œ ì„¸ì…˜ ê´€ë¦¬
- Google OAuth ì¸ì¦ ì§€ì›
- ë¹„ë°€ë²ˆí˜¸ëŠ” bcryptë¡œ í•´ì‹œí™”
- ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ëŠ” ì¸ì¦ ë° ê¶Œí•œ ê²€ì¦ í•„ìš”

### Rate Limiting
- Redis ê¸°ë°˜ rate limiting êµ¬í˜„
- APIë³„ ì œí•œ:
  - ì±„íŒ…: 20íšŒ/ë¶„
  - ë¹„ë””ì˜¤ ìš”ì•½: 10íšŒ/ë¶„
  - ë“±ë¡: 5íšŒ/ë¶„

### ìž…ë ¥ ê²€ì¦ ë° Sanitization
- ëª¨ë“  ì‚¬ìš©ìž ìž…ë ¥ ê²€ì¦ í•„ìˆ˜
- XSS ë°©ì§€ë¥¼ ìœ„í•œ ìž…ë ¥ sanitization
- SQL Injection ë°©ì§€ë¥¼ ìœ„í•œ Prisma íŒŒë¼ë¯¸í„°í™” ì¿¼ë¦¬ ì‚¬ìš©
- íŒŒì¼ ID ë° URL ê²€ì¦

### ë³´ì•ˆ í—¤ë”
- Content Security Policy (CSP) ì„¤ì •
- X-Frame-Options: DENY
- X-Content-Type-Options: nosniff
- Strict-Transport-Security
- SSRF ë°©ì§€ë¥¼ ìœ„í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ URL ê²€ì¦

### í™˜ê²½ ë³€ìˆ˜ ë³´ì•ˆ
- `.env` íŒŒì¼ì€ ë²„ì „ ê´€ë¦¬ì—ì„œ ì œì™¸
- í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” HTTPS í•„ìˆ˜
- ë¯¼ê°í•œ ì •ë³´ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬

## ì•„í‚¤í…ì²˜

### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
online-course/
â”œâ”€â”€ app/                    # Next.js App Router íŽ˜ì´ì§€ ë° API
â”‚   â”œâ”€â”€ api/               # API ë¼ìš°íŠ¸
â”‚   â”œâ”€â”€ courses/           # ì½”ìŠ¤ íŽ˜ì´ì§€
â”‚   â”œâ”€â”€ dashboard/        # ëŒ€ì‹œë³´ë“œ
â”‚   â””â”€â”€ ...
â”œâ”€â”€ components/            # React ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ ui/               # ShadCN UI ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ ...
â”œâ”€â”€ lib/                   # ìœ í‹¸ë¦¬í‹° ë° ë¼ì´ë¸ŒëŸ¬ë¦¬
â”‚   â”œâ”€â”€ auth.ts           # ì¸ì¦ ì„¤ì •
â”‚   â”œâ”€â”€ prisma.ts         # Prisma í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ security.ts       # ë³´ì•ˆ ìœ í‹¸ë¦¬í‹°
â”‚   â””â”€â”€ ...
â”œâ”€â”€ prisma/                # Prisma ìŠ¤í‚¤ë§ˆ ë° ë§ˆì´ê·¸ë ˆì´ì…˜
â”œâ”€â”€ types/                 # TypeScript íƒ€ìž… ì •ì˜
â””â”€â”€ public/                # ì •ì  íŒŒì¼
```

### ë°ì´í„°ë² ì´ìŠ¤ ê´€ê³„
- User â†” Account (1:N)
- User â†” Session (1:N)
- User â†” Chat (1:N)
- User â†” Subscription (1:1)
- Course â†” Video (1:N)
- Video â†” Chat (1:N)

## ë°°í¬

### Vercel ë°°í¬
1. Vercel í”„ë¡œì íŠ¸ ì—°ê²°
2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
3. ë¹Œë“œ ëª…ë ¹ì–´: `npm run vercel-build`
4. ë°°í¬ ìžë™í™” (Git push ì‹œ ìžë™ ë°°í¬)

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (Vercel)
- ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ë¥¼ Vercel ëŒ€ì‹œë³´ë“œì— ì„¤ì •
- `NODE_ENV=production` ìžë™ ì„¤ì •
- `NEXTAUTH_URL`ì„ í”„ë¡œë•ì…˜ ë„ë©”ì¸ìœ¼ë¡œ ì„¤ì •

### ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
ë°°í¬ ì „ ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©:
```bash
npx prisma migrate deploy
```

## í…ŒìŠ¤íŠ¸ ë° í’ˆì§ˆ ê´€ë¦¬

### ë¹Œë“œ ê²€ì¦
```bash
npm run check-build
```

### íƒ€ìž… ì²´í¬
```bash
npm run type-check
```

## ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì˜ì¡´ì„±

### í•µì‹¬ ì˜ì¡´ì„±
- `next`: 14.2.35
- `react`: ^18
- `@prisma/client`: ^6.19.1
- `next-auth`: ^4.24.13
- `openai`: ^4.104.0
- `stripe`: ^17.7.0
- `googleapis`: ^169.0.0

### UI ë¼ì´ë¸ŒëŸ¬ë¦¬
- `@radix-ui/*`: UI ì»´í¬ë„ŒíŠ¸ í”„ë¦¬ë¯¸í‹°ë¸Œ
- `tailwindcss`: CSS í”„ë ˆìž„ì›Œí¬
- `lucide-react`: ì•„ì´ì½˜
- `framer-motion`: ì• ë‹ˆë©”ì´ì…˜

## ê°œë°œ ì›Œí¬í”Œë¡œìš°

### ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ
1. ê¸°ëŠ¥ ë¸Œëžœì¹˜ ìƒì„±
2. í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ ë° API ë¼ìš°íŠ¸ ìž‘ì„±
3. íƒ€ìž… ì •ì˜ ì¶”ê°€ (`types/` ë””ë ‰í† ë¦¬)
4. ë³´ì•ˆ ê²€ì¦ ë° rate limiting ì ìš©
5. íƒ€ìž… ì²´í¬ ë° ë¹Œë“œ ê²€ì¦
6. Pull Request ìƒì„±

### API ë¼ìš°íŠ¸ ìž‘ì„± ì‹œ
1. ìž…ë ¥ ê²€ì¦ í•¨ìˆ˜ ì‚¬ìš© (`lib/security.ts`)
2. Rate limiting ì ìš©
3. ì—ëŸ¬ ì²˜ë¦¬ ë° ì ì ˆí•œ HTTP ìƒíƒœ ì½”ë“œ ë°˜í™˜
4. ë¡œê¹… ì¶”ê°€ (ë¯¼ê°í•œ ì •ë³´ ì œì™¸)

### ì»´í¬ë„ŒíŠ¸ ìž‘ì„± ì‹œ
1. ShadCN ì»´í¬ë„ŒíŠ¸ ìš°ì„  ì‚¬ìš©
2. TypeScript íƒ€ìž… ì •ì˜
3. ë°˜ì‘í˜• ë””ìžì¸ ê³ ë ¤
4. ì ‘ê·¼ì„± ê³ ë ¤ (ARIA ì†ì„± ë“±)

## ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œ

**Prisma Client ì˜¤ë¥˜**
```bash
npx prisma generate
```

**ë¹Œë“œ ì˜¤ë¥˜**
- í™˜ê²½ ë³€ìˆ˜ í™•ì¸
- `SKIP_ENV_VALIDATION=true` ì‚¬ìš© (ë¹Œë“œ ì‹œ)

**ì¸ì¦ ì˜¤ë¥˜**
- `NEXTAUTH_SECRET` ê¸¸ì´ í™•ì¸ (ìµœì†Œ 32ìž)
- `NEXTAUTH_URL` ì„¤ì • í™•ì¸

**ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜**
- `DATABASE_URL` í˜•ì‹ í™•ì¸
- PostgreSQL ì„œë²„ ì‹¤í–‰ ìƒíƒœ í™•ì¸

## ì¶”ê°€ ë¦¬ì†ŒìŠ¤

- [Next.js ë¬¸ì„œ](https://nextjs.org/docs)
- [Prisma ë¬¸ì„œ](https://www.prisma.io/docs)
- [ShadCN UI ë¬¸ì„œ](https://ui.shadcn.com)
- [NextAuth.js ë¬¸ì„œ](https://next-auth.js.org)
- [Stripe ë¬¸ì„œ](https://stripe.com/docs)

## ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ë¥¼ ë”°ë¦…ë‹ˆë‹¤. ìžì„¸í•œ ë‚´ìš©ì€ [LICENSE](LICENSE) íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”.

